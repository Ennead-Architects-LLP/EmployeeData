<!DOCTYPE html>
<html>
<head>
    <title>Test Both Computer Info Formats</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Test Both Computer Info Formats</h1>
    <div id="results"></div>

    <script>
        // Test data with list of dictionaries format
        const employeeWithListFormat = {
            "human_name": "Test User 1",
            "computer_info": [
                {
                    "computername": "PC-001",
                    "os": "Windows 11",
                    "cpu": "Intel i7",
                    "memory_bytes": 16777216000
                },
                {
                    "computername": "PC-002", 
                    "os": "Windows 10",
                    "cpu": "Intel i5",
                    "memory_bytes": 8589934592
                }
            ]
        };

        // Test data with dictionary of dictionaries format
        const employeeWithDictFormat = {
            "human_name": "Test User 2",
            "computer_info": {
                "PC-003": {
                    "computername": "PC-003",
                    "os": "Windows 11",
                    "cpu": "AMD Ryzen 7",
                    "memory_bytes": 17179869184
                },
                "PC-004": {
                    "computername": "PC-004",
                    "os": "Windows 10", 
                    "cpu": "AMD Ryzen 5",
                    "memory_bytes": 8589934592
                }
            }
        };

        // Test the same logic as ui-manager.js
        function processComputerInfo(employee) {
            const computerInfo = employee.computer_info || employee.computer || employee.computer_specs;
            let computers = [];
            
            if (computerInfo) {
                if (Array.isArray(computerInfo)) {
                    // Handle list of dictionaries format: [{computername: "PC1", os: "Windows"}, ...]
                    computers = computerInfo;
                } else if (typeof computerInfo === 'object') {
                    // Handle dictionary of dictionaries format: {"PC1": {computername: "PC1", os: "Windows"}, ...}
                    computers = Object.values(computerInfo);
                }
            }
            
            return computers;
        }

        // Run tests
        function runTests() {
            const results = document.getElementById('results');
            let output = '';

            // Test list format
            output += '<div class="test-section">';
            output += '<h3>Test 1: List of Dictionaries Format</h3>';
            const computers1 = processComputerInfo(employeeWithListFormat);
            output += `<p><strong>Format:</strong> Array (${Array.isArray(employeeWithListFormat.computer_info)})</p>`;
            output += `<p><strong>Computers Found:</strong> ${computers1.length}</p>`;
            computers1.forEach((comp, i) => {
                output += `<p>${i+1}. ${comp.computername} - ${comp.os} - ${comp.cpu}</p>`;
            });
            output += '</div>';

            // Test dict format
            output += '<div class="test-section">';
            output += '<h3>Test 2: Dictionary of Dictionaries Format</h3>';
            const computers2 = processComputerInfo(employeeWithDictFormat);
            output += `<p><strong>Format:</strong> Object (${!Array.isArray(employeeWithDictFormat.computer_info)})</p>`;
            output += `<p><strong>Computers Found:</strong> ${computers2.length}</p>`;
            computers2.forEach((comp, i) => {
                output += `<p>${i+1}. ${comp.computername} - ${comp.os} - ${comp.cpu}</p>`;
            });
            output += '</div>';

            // Test results
            output += '<div class="test-section">';
            output += '<h3>Test Results</h3>';
            if (computers1.length === 2 && computers2.length === 2) {
                output += '<p class="success">✅ Both formats processed correctly!</p>';
            } else {
                output += '<p class="error">❌ One or both formats failed</p>';
            }
            output += '</div>';

            results.innerHTML = output;
        }

        runTests();
    </script>
</body>
</html>
